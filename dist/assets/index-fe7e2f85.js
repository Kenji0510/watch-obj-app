import{a as w,R as Z}from"./vendor-1e052ad9.js";import{C as X,P as Q,a as ee,O as te,u as se,H as re,b as ne}from"./@react-three/drei-094faea8.js";import{C as ie}from"./@react-three/fiber-f89b865d.js";import{V as O,o as k,u as J,v as $,G as oe,n as U,w as M,x as V,M as z,y as C,z as W,I as E,J as A,K as B,X as ae,Y as le,Z as ce,h as T,a as he,_ as ue,$ as pe}from"./three-c0757b61.js";import"./three-stdlib-8df15805.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))n(e);new MutationObserver(e=>{for(const r of e)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function s(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerPolicy&&(r.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?r.credentials="include":e.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(e){if(e.ep)return;e.ep=!0;const r=s(e);fetch(e.href,r)}})();var K={exports:{}},P={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var de=w,fe=Symbol.for("react.element"),me=Symbol.for("react.fragment"),ge=Object.prototype.hasOwnProperty,be=de.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,xe={key:!0,ref:!0,__self:!0,__source:!0};function Y(f,t,s){var n,e={},r=null,a=null;s!==void 0&&(r=""+s),t.key!==void 0&&(r=""+t.key),t.ref!==void 0&&(a=t.ref);for(n in t)ge.call(t,n)&&!xe.hasOwnProperty(n)&&(e[n]=t[n]);if(f&&f.defaultProps)for(n in t=f.defaultProps,t)e[n]===void 0&&(e[n]=t[n]);return{$$typeof:fe,type:f,key:r,ref:a,props:e,_owner:be.current}}P.Fragment=me;P.jsx=Y;P.jsxs=Y;K.exports=P;var p=K.exports;function D(f){return p.jsxs("div",{className:"footer",style:f.style,children:[p.jsx("span",{children:"C3×OPTiM"}),p.jsx("span",{children:"© Simo"})]})}const ve=/^[og]\s*(.+)?/,ye=/^mtllib /,je=/^usemtl /,we=/^usemap /,N=/\s+/,G=new O,S=new O,H=new O,q=new O,j=new O,F=new k;function _e(){const f={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(t,s){if(this.object&&this.object.fromDeclaration===!1){this.object.name=t,this.object.fromDeclaration=s!==!1;return}const n=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:t||"",fromDeclaration:s!==!1,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(e,r){const a=this._finalize(!1);a&&(a.inherited||a.groupCount<=0)&&this.materials.splice(a.index,1);const l={index:this.materials.length,name:e||"",mtllib:Array.isArray(r)&&r.length>0?r[r.length-1]:"",smooth:a!==void 0?a.smooth:this.smooth,groupStart:a!==void 0?a.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(o){const i={index:typeof o=="number"?o:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return i.clone=this.clone.bind(i),i}};return this.materials.push(l),l},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(e){const r=this.currentMaterial();if(r&&r.groupEnd===-1&&(r.groupEnd=this.geometry.vertices.length/3,r.groupCount=r.groupEnd-r.groupStart,r.inherited=!1),e&&this.materials.length>1)for(let a=this.materials.length-1;a>=0;a--)this.materials[a].groupCount<=0&&this.materials.splice(a,1);return e&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),r}},n&&n.name&&typeof n.clone=="function"){const e=n.clone(0);e.inherited=!0,this.object.materials.push(e)}this.objects.push(this.object)},finalize:function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},parseVertexIndex:function(t,s){const n=parseInt(t,10);return(n>=0?n-1:n+s/3)*3},parseNormalIndex:function(t,s){const n=parseInt(t,10);return(n>=0?n-1:n+s/3)*3},parseUVIndex:function(t,s){const n=parseInt(t,10);return(n>=0?n-1:n+s/2)*2},addVertex:function(t,s,n){const e=this.vertices,r=this.object.geometry.vertices;r.push(e[t+0],e[t+1],e[t+2]),r.push(e[s+0],e[s+1],e[s+2]),r.push(e[n+0],e[n+1],e[n+2])},addVertexPoint:function(t){const s=this.vertices;this.object.geometry.vertices.push(s[t+0],s[t+1],s[t+2])},addVertexLine:function(t){const s=this.vertices;this.object.geometry.vertices.push(s[t+0],s[t+1],s[t+2])},addNormal:function(t,s,n){const e=this.normals,r=this.object.geometry.normals;r.push(e[t+0],e[t+1],e[t+2]),r.push(e[s+0],e[s+1],e[s+2]),r.push(e[n+0],e[n+1],e[n+2])},addFaceNormal:function(t,s,n){const e=this.vertices,r=this.object.geometry.normals;G.fromArray(e,t),S.fromArray(e,s),H.fromArray(e,n),j.subVectors(H,S),q.subVectors(G,S),j.cross(q),j.normalize(),r.push(j.x,j.y,j.z),r.push(j.x,j.y,j.z),r.push(j.x,j.y,j.z)},addColor:function(t,s,n){const e=this.colors,r=this.object.geometry.colors;e[t]!==void 0&&r.push(e[t+0],e[t+1],e[t+2]),e[s]!==void 0&&r.push(e[s+0],e[s+1],e[s+2]),e[n]!==void 0&&r.push(e[n+0],e[n+1],e[n+2])},addUV:function(t,s,n){const e=this.uvs,r=this.object.geometry.uvs;r.push(e[t+0],e[t+1]),r.push(e[s+0],e[s+1]),r.push(e[n+0],e[n+1])},addDefaultUV:function(){const t=this.object.geometry.uvs;t.push(0,0),t.push(0,0),t.push(0,0)},addUVLine:function(t){const s=this.uvs;this.object.geometry.uvs.push(s[t+0],s[t+1])},addFace:function(t,s,n,e,r,a,l,o,i){const h=this.vertices.length;let c=this.parseVertexIndex(t,h),u=this.parseVertexIndex(s,h),d=this.parseVertexIndex(n,h);if(this.addVertex(c,u,d),this.addColor(c,u,d),l!==void 0&&l!==""){const b=this.normals.length;c=this.parseNormalIndex(l,b),u=this.parseNormalIndex(o,b),d=this.parseNormalIndex(i,b),this.addNormal(c,u,d)}else this.addFaceNormal(c,u,d);if(e!==void 0&&e!==""){const b=this.uvs.length;c=this.parseUVIndex(e,b),u=this.parseUVIndex(r,b),d=this.parseUVIndex(a,b),this.addUV(c,u,d),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(t){this.object.geometry.type="Points";const s=this.vertices.length;for(let n=0,e=t.length;n<e;n++){const r=this.parseVertexIndex(t[n],s);this.addVertexPoint(r),this.addColor(r)}},addLineGeometry:function(t,s){this.object.geometry.type="Line";const n=this.vertices.length,e=this.uvs.length;for(let r=0,a=t.length;r<a;r++)this.addVertexLine(this.parseVertexIndex(t[r],n));for(let r=0,a=s.length;r<a;r++)this.addUVLine(this.parseUVIndex(s[r],e))}};return f.startObject("",!1),f}class Le extends J{constructor(t){super(t),this.materials=null}load(t,s,n,e){const r=this,a=new $(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(t,function(l){try{s(r.parse(l))}catch(o){e?e(o):console.error(o),r.manager.itemError(t)}},n,e)}setMaterials(t){return this.materials=t,this}parse(t){const s=new _e;t.indexOf(`\r
`)!==-1&&(t=t.replace(/\r\n/g,`
`)),t.indexOf(`\\
`)!==-1&&(t=t.replace(/\\\n/g,""));const n=t.split(`
`);let e=[];for(let l=0,o=n.length;l<o;l++){const i=n[l].trimStart();if(i.length===0)continue;const h=i.charAt(0);if(h!=="#")if(h==="v"){const c=i.split(N);switch(c[0]){case"v":s.vertices.push(parseFloat(c[1]),parseFloat(c[2]),parseFloat(c[3])),c.length>=7?(F.setRGB(parseFloat(c[4]),parseFloat(c[5]),parseFloat(c[6])).convertSRGBToLinear(),s.colors.push(F.r,F.g,F.b)):s.colors.push(void 0,void 0,void 0);break;case"vn":s.normals.push(parseFloat(c[1]),parseFloat(c[2]),parseFloat(c[3]));break;case"vt":s.uvs.push(parseFloat(c[1]),parseFloat(c[2]));break}}else if(h==="f"){const u=i.slice(1).trim().split(N),d=[];for(let m=0,x=u.length;m<x;m++){const v=u[m];if(v.length>0){const y=v.split("/");d.push(y)}}const b=d[0];for(let m=1,x=d.length-1;m<x;m++){const v=d[m],y=d[m+1];s.addFace(b[0],v[0],y[0],b[1],v[1],y[1],b[2],v[2],y[2])}}else if(h==="l"){const c=i.substring(1).trim().split(" ");let u=[];const d=[];if(i.indexOf("/")===-1)u=c;else for(let b=0,m=c.length;b<m;b++){const x=c[b].split("/");x[0]!==""&&u.push(x[0]),x[1]!==""&&d.push(x[1])}s.addLineGeometry(u,d)}else if(h==="p"){const u=i.slice(1).trim().split(" ");s.addPointGeometry(u)}else if((e=ve.exec(i))!==null){const c=(" "+e[0].slice(1).trim()).slice(1);s.startObject(c)}else if(je.test(i))s.object.startMaterial(i.substring(7).trim(),s.materialLibraries);else if(ye.test(i))s.materialLibraries.push(i.substring(7).trim());else if(we.test(i))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if(h==="s"){if(e=i.split(" "),e.length>1){const u=e[1].trim().toLowerCase();s.object.smooth=u!=="0"&&u!=="off"}else s.object.smooth=!0;const c=s.object.currentMaterial();c&&(c.smooth=s.object.smooth)}else{if(i==="\0")continue;console.warn('THREE.OBJLoader: Unexpected line: "'+i+'"')}}s.finalize();const r=new oe;if(r.materialLibraries=[].concat(s.materialLibraries),!(s.objects.length===1&&s.objects[0].geometry.vertices.length===0)===!0)for(let l=0,o=s.objects.length;l<o;l++){const i=s.objects[l],h=i.geometry,c=i.materials,u=h.type==="Line",d=h.type==="Points";let b=!1;if(h.vertices.length===0)continue;const m=new U;m.setAttribute("position",new M(h.vertices,3)),h.normals.length>0&&m.setAttribute("normal",new M(h.normals,3)),h.colors.length>0&&(b=!0,m.setAttribute("color",new M(h.colors,3))),h.hasUVIndices===!0&&m.setAttribute("uv",new M(h.uvs,2));const x=[];for(let y=0,I=c.length;y<I;y++){const _=c[y],R=_.name+"_"+_.smooth+"_"+b;let g=s.materials[R];if(this.materials!==null){if(g=this.materials.create(_.name),u&&g&&!(g instanceof V)){const L=new V;z.prototype.copy.call(L,g),L.color.copy(g.color),g=L}else if(d&&g&&!(g instanceof C)){const L=new C({size:10,sizeAttenuation:!1});z.prototype.copy.call(L,g),L.color.copy(g.color),L.map=g.map,g=L}}g===void 0&&(u?g=new V:d?g=new C({size:1,sizeAttenuation:!1}):g=new W,g.name=_.name,g.flatShading=!_.smooth,g.vertexColors=b,s.materials[R]=g),x.push(g)}let v;if(x.length>1){for(let y=0,I=c.length;y<I;y++){const _=c[y];m.addGroup(_.groupStart,_.groupCount,y)}u?v=new E(m,x):d?v=new A(m,x):v=new B(m,x)}else u?v=new E(m,x[0]):d?v=new A(m,x[0]):v=new B(m,x[0]);v.name=i.name,r.add(v)}else if(s.vertices.length>0){const l=new C({size:1,sizeAttenuation:!1}),o=new U;o.setAttribute("position",new M(s.vertices,3)),s.colors.length>0&&s.colors[0]!==void 0&&(o.setAttribute("color",new M(s.colors,3)),l.vertexColors=!0);const i=new A(o,l);r.add(i)}return r}}class Me extends J{constructor(t){super(t)}load(t,s,n,e){const r=this,a=this.path===""?ae.extractUrlBase(t):this.path,l=new $(this.manager);l.setPath(this.path),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(t,function(o){try{s(r.parse(o,a))}catch(i){e?e(i):console.error(i),r.manager.itemError(t)}},n,e)}setMaterialOptions(t){return this.materialOptions=t,this}parse(t,s){const n=t.split(`
`);let e={};const r=/\s+/,a={};for(let o=0;o<n.length;o++){let i=n[o];if(i=i.trim(),i.length===0||i.charAt(0)==="#")continue;const h=i.indexOf(" ");let c=h>=0?i.substring(0,h):i;c=c.toLowerCase();let u=h>=0?i.substring(h+1):"";if(u=u.trim(),c==="newmtl")e={name:u},a[u]=e;else if(c==="ka"||c==="kd"||c==="ks"||c==="ke"){const d=u.split(r,3);e[c]=[parseFloat(d[0]),parseFloat(d[1]),parseFloat(d[2])]}else e[c]=u}const l=new Oe(this.resourcePath||s,this.materialOptions);return l.setCrossOrigin(this.crossOrigin),l.setManager(this.manager),l.setMaterials(a),l}}class Oe{constructor(t="",s={}){this.baseUrl=t,this.options=s,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.crossOrigin="anonymous",this.side=this.options.side!==void 0?this.options.side:le,this.wrap=this.options.wrap!==void 0?this.options.wrap:ce}setCrossOrigin(t){return this.crossOrigin=t,this}setManager(t){this.manager=t}setMaterials(t){this.materialsInfo=this.convert(t),this.materials={},this.materialsArray=[],this.nameLookup={}}convert(t){if(!this.options)return t;const s={};for(const n in t){const e=t[n],r={};s[n]=r;for(const a in e){let l=!0,o=e[a];const i=a.toLowerCase();switch(i){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(o=[o[0]/255,o[1]/255,o[2]/255]),this.options&&this.options.ignoreZeroRGBs&&o[0]===0&&o[1]===0&&o[2]===0&&(l=!1);break}l&&(r[i]=o)}}return s}preload(){for(const t in this.materialsInfo)this.create(t)}getIndex(t){return this.nameLookup[t]}getAsArray(){let t=0;for(const s in this.materialsInfo)this.materialsArray[t]=this.create(s),this.nameLookup[s]=t,t++;return this.materialsArray}create(t){return this.materials[t]===void 0&&this.createMaterial_(t),this.materials[t]}createMaterial_(t){const s=this,n=this.materialsInfo[t],e={name:t,side:this.side};function r(l,o){return typeof o!="string"||o===""?"":/^https?:\/\//i.test(o)?o:l+o}function a(l,o){if(e[l])return;const i=s.getTextureParams(o,e),h=s.loadTexture(r(s.baseUrl,i.url));h.repeat.copy(i.scale),h.offset.copy(i.offset),h.wrapS=s.wrap,h.wrapT=s.wrap,(l==="map"||l==="emissiveMap")&&(h.colorSpace=pe),e[l]=h}for(const l in n){const o=n[l];let i;if(o!=="")switch(l.toLowerCase()){case"kd":e.color=new k().fromArray(o).convertSRGBToLinear();break;case"ks":e.specular=new k().fromArray(o).convertSRGBToLinear();break;case"ke":e.emissive=new k().fromArray(o).convertSRGBToLinear();break;case"map_kd":a("map",o);break;case"map_ks":a("specularMap",o);break;case"map_ke":a("emissiveMap",o);break;case"norm":a("normalMap",o);break;case"map_bump":case"bump":a("bumpMap",o);break;case"map_d":a("alphaMap",o),e.transparent=!0;break;case"ns":e.shininess=parseFloat(o);break;case"d":i=parseFloat(o),i<1&&(e.opacity=i,e.transparent=!0);break;case"tr":i=parseFloat(o),this.options&&this.options.invertTrProperty&&(i=1-i),i>0&&(e.opacity=1-i,e.transparent=!0);break}}return this.materials[t]=new W(e),this.materials[t]}getTextureParams(t,s){const n={scale:new T(1,1),offset:new T(0,0)},e=t.split(/\s+/);let r;return r=e.indexOf("-bm"),r>=0&&(s.bumpScale=parseFloat(e[r+1]),e.splice(r,2)),r=e.indexOf("-s"),r>=0&&(n.scale.set(parseFloat(e[r+1]),parseFloat(e[r+2])),e.splice(r,4)),r=e.indexOf("-o"),r>=0&&(n.offset.set(parseFloat(e[r+1]),parseFloat(e[r+2])),e.splice(r,4)),n.url=e.join(" ").trim(),n}loadTexture(t,s,n,e,r){const a=this.manager!==void 0?this.manager:he;let l=a.getHandler(t);l===null&&(l=new ue(a)),l.setCrossOrigin&&l.setCrossOrigin(this.crossOrigin);const o=l.load(t,n,e,r);return s!==void 0&&(o.mapping=s),o}}function Ce(){const{progress:f}=se();return console.log(f+"% loading..."),p.jsx(re,{className:"loading"})}const Fe=f=>{const t=w.useRef(null);return w.useEffect(()=>{new Me().load(f.model_url.replace(".obj",".mtl"),n=>{n.preload();const e=new Le;e.setMaterials(n),e.load(f.model_url,r=>{t.current.add(r)})})},[f.model_url]),p.jsx("group",{ref:t})};function ke(f){const t=w.useRef({}),s=w.useRef({});return p.jsxs(p.Fragment,{children:[p.jsxs(w.Suspense,{fallback:p.jsx(Ce,{}),children:[p.jsx(X,{children:p.jsx(Fe,{mesh:s,model_url:f.model_url,position:[0,0,0]})}),p.jsx(Q,{all:!0}),p.jsx(ee,{makeDefault:!0,args:[35,window.innerWidth/window.innerHeight,.1,2e3],position:[-5,4,5]}),p.jsx("ambientLight",{color:"white",intensity:.5}),p.jsx("directionalLight",{color:"white",intensity:.8,position:[1,5,5]})]}),p.jsx(te,{makeDefault:!0,ref:t}),p.jsx("axesHelper",{})]})}function Pe(){const[f,t]=w.useState(0),[s,n]=w.useState([]),e="http://192.168.0.30:8081/",[r,a]=w.useState(!0),l=["https://some-anyone-data.s3.ap-northeast-3.amazonaws.com/public_obj/hotel_in_sunshine/Scaniverse_2023_08_28_184503.obj"];return w.useEffect(()=>{(async()=>{a(!0);try{let h=await(await fetch(e)).json();console.log(h);const c=await h.map(u=>u.ObjFileName);n(c),console.log(c)}catch(i){console.log("Error fetching the data:",i)}a(!1)})()},[]),p.jsxs("div",{className:"App",children:[p.jsx("h1",{className:"Title",children:"OBJファイル可視化サイト"}),r?p.jsx("p",{children:"Loading..."}):p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"model_switch_button",children:s.map((o,i)=>p.jsx("div",{className:`${i===f?"selected":""}`,onClick:()=>{t(i)},children:i+1},i))}),s.length>0&&p.jsx(ie,{className:"canvas",children:p.jsx(ke,{model_url:l[0]},0)}),p.jsx(D,{}),p.jsx(D,{})]})]})}const Ie=ne.createRoot(document.getElementById("root"));Ie.render(p.jsx(Z.StrictMode,{children:p.jsx(Pe,{})}));
